!function(t){var r={};function e(n){if(r[n])return r[n].exports;var i=r[n]={i:n,l:!1,exports:{}};return t[n].call(i.exports,i,i.exports,e),i.l=!0,i.exports}e.m=t,e.c=r,e.d=function(t,r,n){e.o(t,r)||Object.defineProperty(t,r,{enumerable:!0,get:n})},e.r=function(t){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(t,"__esModule",{value:!0})},e.t=function(t,r){if(1&r&&(t=e(t)),8&r)return t;if(4&r&&"object"==typeof t&&t&&t.__esModule)return t;var n=Object.create(null);if(e.r(n),Object.defineProperty(n,"default",{enumerable:!0,value:t}),2&r&&"string"!=typeof t)for(var i in t)e.d(n,i,function(r){return t[r]}.bind(null,i));return n},e.n=function(t){var r=t&&t.__esModule?function(){return t.default}:function(){return t};return e.d(r,"a",r),r},e.o=function(t,r){return Object.prototype.hasOwnProperty.call(t,r)},e.p="",e(e.s=0)}([function(t,r,e){"use strict";e.r(r);var n=32,i=8191,o=64,a=128,s=31,u=function(){var t=function(r,e){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,r){t.__proto__=r}||function(t,r){for(var e in r)r.hasOwnProperty(e)&&(t[e]=r[e])})(r,e)};return function(r,e){function n(){this.constructor=r}t(r,e),r.prototype=null===e?Object.create(e):(n.prototype=e.prototype,new n)}}(),l=function(t){function r(e){var n=t.call(this,e)||this;return n.name="TlvError",Object.setPrototypeOf(n,r.prototype),n}return u(r,t),r}(Error),c=function(){return function(t,r,e,n){this.type=t,this.nonCriticalFlag=r,this.forwardFlag=e,this.valueBytes=n}}();(function(){function t(t){this.data=new Uint8Array(t),this.position=0,this.length=t.length}t.prototype.getPosition=function(){return this.position},t.prototype.getLength=function(){return this.length},t.prototype.readTag=function(){var t,r=this.readByte(),e=0!=(r&n),i=0!=(r&o),u=r&s&255;0!=(r&a)?(u=u<<8|this.readByte(),t=this.readShort()):t=this.readByte();var l=this.read(t);return new c(u,i,e,l)},t.prototype.readByte=function(){if(this.length<=this.position)throw new l("Could not read byte: Premature end of data");return 255&this.data[this.position++]},t.prototype.readShort=function(){return this.readByte()<<8|this.readByte()},t.prototype.read=function(t){if(this.length<this.position+t)throw new l("Could not read "+t+" bytes: Premature end of data");var r=this.data.subarray(this.position,this.position+t);return this.position+=t,r}})(),function(){function t(){this.data=new Uint8Array(0)}t.prototype.getData=function(){return new Uint8Array(this.data)},t.prototype.writeTag=function(t){if(t.type>i)throw new l("Could not write TlvTag: Type is larger than max type");if(t.valueBytes.length>65535)throw new l("Could not write TlvTag: Data length is too large");var r=t.type>s||t.valueBytes.length>255,e=(r||a)+(t.nonCriticalFlag||o)+(t.forwardFlag||n);r?(e|=t.type>>8&s,this.write(new Uint8Array([255&e,255&t.type,t.valueBytes.length>>8&255,255&t.valueBytes.length]))):(e|=t.type&s,this.write(new Uint8Array([e,255&t.valueBytes.length]))),this.write(t.valueBytes)},t.prototype.write=function(t){var r=new Uint8Array(this.data.length+t.length);r.set(this.data),r.set(t,this.data.length),this.data=r}}();class h{static ToBytes(t){if("string"!=typeof t)throw new Error("Invalid string");const r=[];for(let e=0;e<t.length;e++)r.push(t.charCodeAt(e));return new Uint8Array(r)}static ToString(t){if(!(t instanceof Uint8Array))throw new Error("Invalid byte array");return String.fromCharCode.apply(null,t.subarray(0,t.length))}}const f="0123456789ABCDEF",y={0:0,1:1,2:2,3:3,4:4,5:5,6:6,7:7,8:8,9:9,A:10,B:11,C:12,D:13,E:14,F:15};class p{static encode(t){if(!(t instanceof Uint8Array))throw new Error("Invalid array for converting to hex");let r="";for(let e=0;e<t.length;e++){if(t[e]>255)throw new Error("Invalid byte");r+=f[(240&t[e])>>4],r+=f[15&t[e]]}return r}static decode(t){if("string"!=typeof t)throw new Error("Invalid hex string");if(t.length%2!=0)throw new Error("Octet string should have equal amount of characters");const r=t.toUpperCase(),e=[];for(let t=0;t<r.length;t+=2){if(void 0===y[r[t]]||void 0===y[r[t+1]])throw new Error("Invalid HEX");e.push((y[r[t]]<<4)+y[r[t+1]])}return new Uint8Array(e)}static encodeByteString(t){return p.encode(h.ToBytes(t))}static decodeToByteString(t){return h.ToString(p.decode(t))}}class g{static get SHA1(){return d}static get SHA2_256(){return w}static get RIPEMD160(){return v}static get SHA2_224(){return A}static get SHA2_384(){return S}static get SHA2_512(){return _}static get SHA3_224(){return m}static get SHA3_256(){return b}static get SHA3_384(){return B}static get SHA3_512(){return H}static get SM3(){return E}static getById(t){const r=g.Values();for(const e in r)if(r[e].id==t)return r[e];return null}static Values(){return[d,w,v,A,S,_,m,b,B,H,E]}constructor(t,r,e){this.id=t,this.name=r,this.length=e}}const d=new g(0,"SHA-1",20),w=new g(1,"SHA-256",32),v=new g(2,"RIPEMD160",20),A=new g(3,"SHA-224",28),S=new g(4,"SHA-384",48),_=new g(5,"SHA-512",64),m=new g(7,"SHA3-224",28),b=new g(8,"SHA3-256",32),B=new g(9,"SHA3-384",48),H=new g(10,"SHA3-512",64),E=new g(11,"SM3",32);class O{constructor(t){if(!(t instanceof Uint8Array))throw new Error("Invalid imprint bytes");let r=g.getById(t[0]);if(null===r)throw Error(`Invalid algorithm id: ${t[0]}`);if(this.hashAlgorithm=r,null==this.hashAlgorithm)throw new Error("Invalid HashAlgorithm");if(this.value=new Uint8Array(t.subarray(1)),this.value.length!=this.hashAlgorithm.length)throw new Error("Invalid algorithm data length");this.imprint=new Uint8Array(t),Object.freeze(this)}static create(t,r){if(!(t instanceof g))throw new Error("Invalid HashAlgorithm");if(!(r instanceof Uint8Array))throw new Error("Invalid value");const e=new Uint8Array(r.length+1);return e[0]=t.id,e.set(r,1),new O(e)}static equals(t,r){if(!(t instanceof O&&r instanceof O))return!1;if(t.imprint.length!=r.imprint.length)return!1;for(let e=0;e<t.imprint.length;e++)if(t.imprint[e]!==r.imprint[e])return!1;return!0}toString(){return p.encode(this.imprint)}equals(t){return O.equals(this,t)}}var I=function(){var t=function(r,e){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,r){t.__proto__=r}||function(t,r){for(var e in r)r.hasOwnProperty(e)&&(t[e]=r[e])})(r,e)};return function(r,e){function n(){this.constructor=r}t(r,e),r.prototype=null===e?Object.create(e):(n.prototype=e.prototype,new n)}}();!function(t){function r(r){var e=t.call(this,r.type,r.nonCriticalFlag,r.forwardFlag,r.valueBytes)||this;return e.value=new O(r.valueBytes),Object.freeze(e),e}I(r,t),r.create=function(t,e,n,i){return new r(new c(t,e,n,i.imprint))},r.prototype.toString=function(){var t="TLV[0x"+this.type.toString(16);return this.nonCriticalFlag&&(t+=",N"),this.forwardFlag&&(t+=",F"),t+="]:",t+=this.value.toString()}}(c)}]);